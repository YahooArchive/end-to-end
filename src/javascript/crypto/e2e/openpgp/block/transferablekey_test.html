<!-- Copyright 2013 Google Inc. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// Author:  koto@google.com (Krzysztof Kotowicz)
// Author:  kbsriram@gmail.com (KB Sriram) - a few testcases
// -->
<!DOCTYPE html>
<title>Unit Test of e2e.block.TransferableKey</title>
<script src="../../../../../../javascript/closure/base.js"></script>
<script src="test_js_deps-runfiles.js"></script>
<script>
  goog.require('goog.array');
  goog.require('goog.testing.jsunit');
  goog.require('e2e.openpgp.block.all');
  goog.require('e2e.openpgp.block.factory');
  goog.require('e2e.cipher.all');
  goog.require('e2e.signer.all');
 </script>

<!--
Public key block containing a signing subkey (with binding 0x19 signature)
:public key packet:
  version 4, algo 1, created 1408612889, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:user ID packet: "signing-subkey <signing-subkey@example.com>"
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408612889, md5len 0, sigclass 0x13
  digest algo 2, begin of digest e9 eb
  hashed subpkt 2 len 4 (sig created 2014-08-21)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  data: [1024 bits]
:public sub key packet:
  version 4, algo 1, created 1408612889, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408612889, md5len 0, sigclass 0x18
  digest algo 2, begin of digest b1 7c
  hashed subpkt 2 len 4 (sig created 2014-08-21)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  data: [1024 bits]
:public sub key packet:
  version 4, algo 1, created 1408612974, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408612974, md5len 0, sigclass 0x18
  digest algo 2, begin of digest 93 5a
  hashed subpkt 2 len 4 (sig created 2014-08-21)
  hashed subpkt 27 len 1 (key flags: 02)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  subpkt 32 len 156 (signature: v4, class 0x19, algo 1, digest algo 2)
  data: [1021 bits]
-->
<textarea id="SigningSubkey">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2

mI0EU/W6GQEEALr7DpMdrxW2/X1GTepEeABgojRLY7TdGBGR6r7VWzmKh2agQdAC
FyvBcRb/tGwwZmimxyxsws7o+2h3oaM8GL0OQ9WEi1035G5DQweHM989Yw84Dj1O
WeXZxRKAqU93+rEz6xys9BYteqL6SNyNt29EjZ7W+mRtWCRUxViaJhGhABEBAAG0
K3NpZ25pbmctc3Via2V5IDxzaWduaW5nLXN1YmtleUBleGFtcGxlLmNvbT6ItwQT
AQIAIQUCU/W6GQIbAwYLCQgHAwIGFQgCCQoLAxYCAQIeAQIXgAAKCRBqaacQD4xc
R+nrBACSTSve7hlxRONletyvDIeQWewQi6ePXkPGWElPrvf8BjEynDMsJHJiDblO
rv0uvpELS2v+OvzJLGD97arenkfWq7PTp7Lm/CWdrJmvCFTZc2gUyTtxMExre2co
uTpfsUNwZudQwe/n9X9oQ0gAXyT79puJ44SqJ5rB2iQj97YOtbiNBFP1uhkBBACi
80AIcHy8YG2UrfCEy+pThYBJxevsS34ne4jwPQFvQe6XULojujaZ8mUmQ3QeNLhS
oBS6q3zhE/FCSpbjt6IWTmYqXz4gH1AGxCv3kEfUc4s1iVj2/u9lNP7Sh7nzNlFp
mfy59uxn4bS1qXf0K6bVIJMj2T3Aq73bOyk/DWvUqwARAQABiJ8EGAECAAkFAlP1
uhkCGwwACgkQammnEA+MXEexfAQAo7wANLUBF9SMKsoGtMZGgIHXpc27E25Nr2IN
/du5mM7MvJXz7wSU8upw89q2g2LvmpoxMshWfw1hRLR92KIzNEb6HFt/WfIxLBeO
RKLu+kETTWN4cnbU8Rtg8Rvw7OY92/vnvwjv1HXXF2qAbf+Lj0Jy7e6h7C+dAXfS
ZdLlE924jQRT9bpuAQQApdRMs7l2uCQtQOg2qRyoUbQdkaCj+6ON5hvN7swUkLaN
zOT6E0V+mQUjHDbnbS8U3sFEyOwciNvzt1KRKUhsZFN4xaPSYXECw1JQMcZczZ2w
9OOcJrVLpJFrv5cQFrx5X9jfTWePXuC40rXzPZ/RvggSMSlW+dWeFPFA2OYszOkA
EQEAAYkBPQQYAQIACQUCU/W6bgIbAgCoCRBqaacQD4xcR50gBBkBAgAGBQJT9bpu
AAoJEPTeZfMn+FaMeIQD/iNfsKYvRPWHEDcSHL8Cp5Gsf8fshrl4yA7md0SFq627
BtW+wYSBoUE1yuMQhQ64mzMOawvw9kZlYYZuMNmzaY9wtlSe8JpNm0OW10vp7bv3
FNaxBfJa2d+G8wkMPthAbSISd25P6LN1E3szD1IXpnTpY3GMfy1Ed8PFDD5IX26n
k1oD/RBBJp4qH81YpH4PrbBDtliH4xvSHZB/VxAf0AyUmCPj6Mk7SeOFpPayvpMs
ygwBuLvy1JANBI3DLckdmI1tSeOScBpjWqmtWB92U7G3s6bOtyDioDsjBrKzrx8G
RYE/ktdjGkfHqR4TSu7/51yofDGLY1ZHXUp9Kk3PbKWH4Uw5
=8AAO
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Revoked subkey:
:public key packet:
  version 4, algo 1, created 1402245840, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:user ID packet: "revoked <revoked@revoked.net>"
:signature packet: algo 1, keyid 1875FF0B267CDC0E
  version 4, created 1402245840, md5len 0, sigclass 0x13
  digest algo 2, begin of digest c0 34
  hashed subpkt 2 len 4 (sig created 2014-06-08)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID 1875FF0B267CDC0E)
  data: [2047 bits]
:public sub key packet:
  version 4, algo 1, created 1402245840, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 1875FF0B267CDC0E
  version 4, created 1402245876, md5len 0, sigclass 0x28
  digest algo 2, begin of digest b6 9d
  hashed subpkt 2 len 4 (sig created 2014-06-08)
  hashed subpkt 29 len 14 (revocation reason 0x02 (revoke subkey))
  subpkt 16 len 8 (issuer key ID 1875FF0B267CDC0E)
  data: [2047 bits]
:signature packet: algo 1, keyid 1875FF0B267CDC0E
  version 4, created 1402245840, md5len 0, sigclass 0x18
  digest algo 2, begin of digest 1d 4e
  hashed subpkt 2 len 4 (sig created 2014-06-08)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID 1875FF0B267CDC0E)
  data: [2048 bits]
-->
<textarea id="RevokedSubKey">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1

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
=80Vy
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Revoked main key:
// Key generation instruction:
// gpg --gen-key (RSA/RSA/1024 - uid=revoked-main)
// gpg --edit revoked-main
// gpg> revkey, key has been compromised, save, quit
:public key packet:
  version 4, algo 1, created 1408442396, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 44416104FBFEA899
  version 4, created 1408442501, md5len 0, sigclass 0x20
  digest algo 2, begin of digest 19 4c
  hashed subpkt 2 len 4 (sig created 2014-08-19)
  hashed subpkt 29 len 25 (revocation reason 0x02 (Main key revocation test))
  subpkt 16 len 8 (issuer key ID 44416104FBFEA899)
  data: [1024 bits]
:user ID packet: "revoked-main <revoked-main@example.com>"
:signature packet: algo 1, keyid 44416104FBFEA899
  version 4, created 1408442396, md5len 0, sigclass 0x13
  digest algo 2, begin of digest c2 1a
  hashed subpkt 2 len 4 (sig created 2014-08-19)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID 44416104FBFEA899)
  data: [1022 bits]
:public sub key packet:
  version 4, algo 1, created 1408442396, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 44416104FBFEA899
  version 4, created 1408442396, md5len 0, sigclass 0x18
  digest algo 2, begin of digest b4 39
  hashed subpkt 2 len 4 (sig created 2014-08-19)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID 44416104FBFEA899)
  data: [1022 bits]
-->
<textarea id="RevokedMainKey">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2

mI0EU/MgHAEEALgGq+UDj7R5XwEl3wDzx4M2K3oBJI6ISuc7nJTCbNrcZ2yahAdF
i9Qmunoa8/rryHQZovuBX4QjkZsxorVzFmH+qvaczUYYMsN6vXGKAsPn0OX6AjRs
VesFtqZyi3yW9pLZaCRuikWeUumgJdbFBFS6uoGGwDKK0X1sqajFGIrlABEBAAGI
twQgAQIAIQUCU/MghRodAk1haW4ga2V5IHJldm9jYXRpb24gdGVzdAAKCRBEQWEE
+/6omRlMBACHerNXj6TFIf/h9yjVnL2PmvoMuAVMftVOnXJQq3ikW44Hu9iY+YwX
M6cevKXETAGuEhvKmBAneNUoC0oaQvel5G7VHQTJqlhVRzpv1M/Rqj3879VbGsSh
gmthv8y2lcPRcXvsB0FY/Jxi4v26CcvreYa77efvywuLD+fTaVOY6bQncmV2b2tl
ZC1tYWluIDxyZXZva2VkLW1haW5AZXhhbXBsZS5jb20+iLcEEwECACEFAlPzIBwC
GwMGCwkIBwMCBhUIAgkKCwMWAgECHgECF4AACgkQREFhBPv+qJnCGgP+LvSRVdS4
K+8Ps/LVplD8DP5jDOnMQIHanr85g8RD76gCXD7vqTCaQZbrwRwR43C1g+CB47vJ
l7jToVhjhdGKHKiRxoyF/xwhTDM9LtWA1PwneecoMYTTR4f8dvd+gX/BAOfwahlP
R/CoC8sUflBWb3nezl7mRXpKhVnLxo5DJKC4jQRT8yAcAQQA6xCjxRKKSPxp2lMl
Bd3a+qPtrW32THL7H0dpq+FJ0UiuP78Z6nQ1DWdMFIgQx4SBoBpnTlYNjiG4+XIk
e1WOVvLMpgBTjPHk/BCrweZhHbV/BF97sLxHcqDU40Uf/UUFweEUbVHAD5XrQasz
JmP9EAUUSEDUh/hh5tnPf/avw1sAEQEAAYifBBgBAgAJBQJT8yAcAhsMAAoJEERB
YQT7/qiZtDkD/jCMvfGLZDbw4pjPT/iHTynmltD57X946rqAkOp0mKdyxKS6CbIZ
nR2/cVSIeQoSBWU+qTj52Uw5bWj3uOVvJNfcAPOt7oyYdUJR0WojD7HXYJH9ym0G
/fgSVhEjpq3TDFQQ/s41bw6Nqbnqn+UAdOi97x9ow+zHd2OtVbnCICRE
=VB3i
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
ECC key to check subkey/user id signature verification.
:public key packet:
  version 4, algo 19, created 1377714336, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  keyid: EAEB8A76AFE8C867
:user ID packet: "ecc real name <ecc@example.com>"
:signature packet: algo 19, keyid EAEB8A76AFE8C867
  version 4, created 1377714336, md5len 0, sigclass 0x13
  digest algo 8, begin of digest c6 d7
  hashed subpkt 2 len 4 (sig created 2013-08-28)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID EAEB8A76AFE8C867)
  data: [254 bits]
  data: [254 bits]
:public sub key packet:
  version 4, algo 18, created 1377714336, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  pkey[2]: [32 bits]
  keyid: DBA95B52C1FBBA97
:signature packet: algo 19, keyid EAEB8A76AFE8C867
  version 4, created 1377714336, md5len 0, sigclass 0x18
  digest algo 8, begin of digest 3a 90
  hashed subpkt 2 len 4 (sig created 2013-08-28)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID EAEB8A76AFE8C867)
  data: [256 bits]
  data: [253 bits]
-->
<textarea id="EccKey">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2.1.0-ecc (GNU/Linux)

mFIEUh5AoBMIKoZIzj0DAQcCAwT68182duSEJFXKa+qkBa0Vgeswnv8GP8tKYiU/
MCZd6dGTvrtf2gSjyAsVkB0V0idW7i8yW1wfh3y2AbGWDr/dtB9lY2MgcmVhbCBu
YW1lIDxlY2NAZXhhbXBsZS5jb20+iHoEExMIACIFAlIeQKACGwMGCwkIBwMCBhUI
AgkKCwQWAgMBAh4BAheAAAoJEOrrinav6MhnxtcA/iAteDFo/P5SU5XV/8/4BN9x
f28SuvwFipnjjyOmvB0eAP4kPM5LAp2EW+QIyG6+CJP1No9uWyZTdLPkTRgLtYhi
GLhWBFIeQKASCCqGSM49AwEHAgMEgk1dVpgPCM38NBNoBcvehm7mt6aUmK8mDb/M
SHo2/NlwfTh+BDCoVX5asSetzuW2RbnP6sCBwfsuLSrSWUVauwMBCAeIYQQYEwgA
CQUCUh5AoAIbDAAKCRDq64p2r+jIZzqQAQCcv0VOQFiNOM6JNdLHTqlCYxeoz09d
UP3LdgcnLED/YwD9FqcNrkok9BuXJ9+rXTSu+uqdWB7gpMO9mfk65d5IQ+s=
=xRCj
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Revoked one of two user IDs. Both user IDs are additionally signed by a
foreign key.

:public key packet:
  version 4, algo 19, created 1408970397, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  keyid: E3CE624C647B3A23
:user ID packet: "revoked-userid <revoked-userid@example.com>"
:signature packet: algo 19, keyid E3CE624C647B3A23
  version 4, created 1408970568, md5len 0, sigclass 0x30
  digest algo 8, begin of digest 1c f0
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 29 len 27 (revocation reason 0x20 (Revocation because why not))
  subpkt 16 len 8 (issuer key ID E3CE624C647B3A23)
  data: [256 bits]
  data: [255 bits]
:signature packet: algo 19, keyid E3CE624C647B3A23
  version 4, created 1408970397, md5len 0, sigclass 0x13
  digest algo 8, begin of digest 77 ed
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID E3CE624C647B3A23)
  data: [255 bits]
  data: [256 bits]
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408970499, md5len 0, sigclass 0x10
  digest algo 2, begin of digest 83 58
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  data: [1023 bits]
:user ID packet: "non-revoked-uid <non-revoked-uid@example.com>"
:signature packet: algo 19, keyid E3CE624C647B3A23
  version 4, created 1408970478, md5len 0, sigclass 0x13
  digest algo 8, begin of digest b9 c1
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID E3CE624C647B3A23)
  data: [256 bits]
  data: [256 bits]
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408970530, md5len 0, sigclass 0x10
  digest algo 2, begin of digest c8 26
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  data: [1024 bits]
:public sub key packet:
  version 4, algo 18, created 1408970397, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  pkey[2]: [32 bits]
  keyid: 4A5DD549DCAB5055
:signature packet: algo 19, keyid E3CE624C647B3A23
  version 4, created 1408970397, md5len 0, sigclass 0x18
  digest algo 8, begin of digest c3 f7
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID E3CE624C647B3A23)
  data: [256 bits]
  data: [256 bits]
-->
<textarea id="RevokedUserId">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2

mFIEU/sunRMIKoZIzj0DAQcCAwSRgY4eg7fVp2ILsmsFI4oZ2eXsqgemV7kNGuWa
tA+gmCXTxoLc2IK6PVM+93u4AJObM7Cm/6vJHW95Ohs8cqXWtCtyZXZva2VkLXVz
ZXJpZCA8cmV2b2tlZC11c2VyaWRAZXhhbXBsZS5jb20+iHsEMBMIACMFAlP7L0gc
HSBSZXZvY2F0aW9uIGJlY2F1c2Ugd2h5IG5vdAAKCRDjzmJMZHs6IxzwAQD7v+oy
LR2Ea2cMO4bhRG5KKqg5sJfIdm5QIWBKNCYDGQD/Qnb5/uNa1I4KLxVF2bpouHWO
cbyvp3Tk2163gSYgu3eIeQQTEwgAIQUCU/sunQIbAwYLCQgHAwIGFQgCCQoLAxYC
AQIeAQIXgAAKCRDjzmJMZHs6I3ftAP9Q2bQYrXij2IoBFfWCxD0nRc2PibyTY0ea
v4yG/Yrc9wEAhlQEKK5zgm+dIyuTufuYxPerrX/KcYRfTSMxoeLG7KaInAQQAQIA
BgUCU/svAwAKCRBqaacQD4xcR4NYA/9ohUViw/7kCVV2FQaQ4L22dNC/VdHKg+eL
U/5hR/Cdn8BwVKuQV8mqxuoDHLw+rg21MGYO5npiauUrewSvN1uoPBRKHZEL1gTj
Opf2dNesGP2xt1nv3TBzIxhDoovG/BXFLYuPeyiladYr6a48BF8iTpH8ESeO5SoV
0eVqT7ywtbQtbm9uLXJldm9rZWQtdWlkIDxub24tcmV2b2tlZC11aWRAZXhhbXBs
ZS5jb20+iHkEExMIACEFAlP7Lu4CGwMGCwkIBwMCBhUIAgkKCwMWAgECHgECF4AA
CgkQ485iTGR7OiO5wQEAmS1n8oOVj6c3L8wdsOVPFSJ0BDGjgkHU5c58LPuKWjsB
AMf3ukqQrQ7kojTXU6MmiGIQhZ9VWpuVcIzo0jMI/4o3iJwEEAECAAYFAlP7LyIA
CgkQammnEA+MXEfIJgQAqjUAlIjw9+Ya658RWZCbSE6Jf8kAjn6YKQVbC633WpXC
Jx9zeqptMebx7nxQTO/6KVUUFMC4U4z5zS8jP6tJYHvd3tgGXFAqF/YSMMAHiiK4
QTNlIE2x+nGrKaOlge9kypCjri2a1gTE9EQxIzVGUVq5gh/IaA1fYL/qqrROQP+4
VgRT+y6dEggqhkjOPQMBBwIDBPXHqP0+8NdmZV/UwPlp4lGbk/sjpBllI4WNTFC/
fsIfZQL9Ud/7uQQtoENfEG/lNW8wSP9AFfsiQDNIB+V08MoDAQgHiGEEGBMIAAkF
AlP7Lp0CGwwACgkQ485iTGR7OiPD9wEAirEelh1tRYGxy1Ghu9NBxLwXhY4BWtNd
NPC1SyXUmj0BAMi7TSyZFM1ETkAJJ1fnRREC1jBFHBBCg2J8Iwt0DCA7
=8vBI
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Key with user attribute packet
:public key packet:
  version 4, algo 19, created 1408973778, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  keyid: D66B9F52D48A1C09
:user ID packet: "user-attr <user-attr@example.com>"
:signature packet: algo 19, keyid D66B9F52D48A1C09
  version 4, created 1408973778, md5len 0, sigclass 0x13
  digest algo 8, begin of digest a2 75
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID D66B9F52D48A1C09)
  data: [256 bits]
  data: [253 bits]
:attribute packet: [jpeg image of size 6078]
:signature packet: algo 19, keyid D66B9F52D48A1C09
  version 4, created 1408973923, md5len 0, sigclass 0x13
  digest algo 8, begin of digest cc 0d
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID D66B9F52D48A1C09)
  data: [256 bits]
  data: [256 bits]
:public sub key packet:
  version 4, algo 18, created 1408973778, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  pkey[2]: [32 bits]
  keyid: F253FF905C7BE669
:signature packet: algo 19, keyid D66B9F52D48A1C09
  version 4, created 1408973778, md5len 0, sigclass 0x18
  digest algo 8, begin of digest 7e 50
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID D66B9F52D48A1C09)
  data: [256 bits]
  data: [256 bits]
-->
<textarea id="UserAttr">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2

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
GUlOSbBIO0YLTF2/1JxqHAlyk0E+WuNVyii53Q==
=lcS+
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
RSA keys. Only the 2nd subkey should be used for encryption, as noted in the
flags.

pub  1024R/5DDBA594  created: 2014-09-03  expires: never       usage: SCE
                     trust: ultimate      validity: ultimate
sub  1024R/8D9632F1  created: 2014-09-03  expires: never       usage: A
sub  1024R/B6307BCA  created: 2014-09-03  expires: never       usage: E
[ultimate] (1). different-encryption-subkey
    <different-encryption-subkey@example.com>

:public key packet:
  version 4, algo 1, created 1409749099, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:user ID packet: "different-encryption-subkey <different-encryption-subkey@example.com>"
:signature packet: algo 1, keyid D423EB9C5DDBA594
  version 4, created 1409749099, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 73 c6
  hashed subpkt 2 len 4 (sig created 2014-09-03)
  hashed subpkt 27 len 1 (key flags: 0F)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID D423EB9C5DDBA594)
  data: [1023 bits]
:public sub key packet:
  version 4, algo 1, created 1409749141, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid D423EB9C5DDBA594
  version 4, created 1409749141, md5len 0, sigclass 0x18
  digest algo 2, begin of digest b1 8e
  hashed subpkt 2 len 4 (sig created 2014-09-03)
  hashed subpkt 27 len 1 (key flags: 20)
  subpkt 16 len 8 (issuer key ID D423EB9C5DDBA594)
  data: [1024 bits]
:public sub key packet:
  version 4, algo 1, created 1409749184, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid D423EB9C5DDBA594
  version 4, created 1409749184, md5len 0, sigclass 0x18
  digest algo 2, begin of digest a0 b4
  hashed subpkt 2 len 4 (sig created 2014-09-03)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID D423EB9C5DDBA594)
-->
<textarea id="GnuPgKeyUsageFlags">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.4.11 (GNU/Linux)

mI0EVAcQawEEAN3GlVqNbwKGrM3TjUfunatWqY5dzdBPyHMSQAt7tFbH3Mm8AZg7
egdWduEYSBD9GRt89QGDhfjLhPa2YUqemnLXVsqnEYrtthmwidzNOVvb25ItYZSZ
F0EYPk4TCPNLsbzaTC2KaWKNaZ6M0Fl/Oy5qKiUefBFlIR9py7+feelTABEBAAG0
RWRpZmZlcmVudC1lbmNyeXB0aW9uLXN1YmtleSA8ZGlmZmVyZW50LWVuY3J5cHRp
b24tc3Via2V5QGV4YW1wbGUuY29tPoi4BBMBAgAiBQJUBxBrAhsPBgsJCAcDAgYV
CAIJCgsEFgIDAQIeAQIXgAAKCRDUI+ucXdullHPGA/9SfXE8QSQoREWrJoAwI/Pg
/SmErfJDqwwAsnf+NHC2IUiiA4nm8+rV7LAgw3DZ/WfxQDOuyj2iwxFXDt+KEpmp
TRWspvBVreDoJrVsHOU/1OQNJKDdgIxapQhCLFaAOqfFIugAN6NuMFOHev+9yJC0
mt0Q02Zp+p3XMMiNYsz5tbiNBFQHEJUBBADc6N8Bsg0Glmt3Y47AyIfFh7l6b13t
tQ3E0ok3lgE/6SGcnmHf5HN2V3qxdyP/DZJmtNp56MBJdzpDPKnFovTqGKPz6bNz
HnhDxpBDl0AV3JRhVd6/GwpYT4atvC7Djhw7y3QGWPBRQSok+2VyTCLoOaohIklg
voHBG/2lNl5j9wARAQABiJ8EGAECAAkFAlQHEJUCGyAACgkQ1CPrnF3bpZSxjgQA
0dES+OPzNfC/lE8pTCNKCsghHS9F3jvOPq8LYLlYUExiZXHpKHvK7iK0SO7T+AXc
ICR0g3rZnGa4VEupA3J8T8i7SYAiipfS/0jWaq9ffvUYA5A7ZsaoRpTijU00UfAC
etpSf8nUXM0S8U1zsOtwGADtbdAZRKGljCR2EVGt5dy4jQRUBxDAAQQAr/qpkl7M
vYc0L6cKGZLk6HaPYsOpZCmkhGhLdls9wA4n9z9j7Y0M3Z9h/ZaGvBq4leNTAM3p
70uLUTZw9izfZqY3RSBDwPApfT4zWobcWfyPOg0AS5+fraahcAyZXbqyWjVkg8Bs
b5cBV+TLW3x6FlyedXwgJ8trGSwgOMHod6cAEQEAAYifBBgBAgAJBQJUBxDAAhsM
AAoJENQj65xd26WUoLQD/0WLj5Xbg3RpZ0JAKEyi5IBqJ9thZz7JOE0cJtqcjhzA
SFg0U0bwROqmKl3upwok+mrlw5SuTJOMNNGACrFoco/z5Q53t4TgvqD4rF/PPCM5
j/GbY0dnReClicttomuqZKLB3ANeap1s8cmJSinmtL+0lwNUzW/swRX3rw/Fo1Mn
=x53K
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
  The primary key can neither sign nor encrypt. It has a single
  signing subkey. It should return a null if a public encryption
  subkey is requested.

:public key packet:
  version 4, algo 1, created 1418654084, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
  keyid: 8A20F7D9D02291A5
:user ID packet: "gpg-test <gpg-s2k@test.com>"
:signature packet: algo 1, keyid 8A20F7D9D02291A5
  version 4, created 1418654084, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 65 21
  hashed subpkt 2 len 4 (sig created 2014-12-15)
  hashed subpkt 27 len 1 (key flags: 01)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID 8A20F7D9D02291A5)
  data: [1024 bits]
:public sub key packet:
  version 4, algo 1, created 1418654101, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
  keyid: 87EBC27D4CA8E30D
:signature packet: algo 1, keyid 8A20F7D9D02291A5
  version 4, created 1418654101, md5len 0, sigclass 0x18
  digest algo 2, begin of digest c1 e5
  hashed subpkt 2 len 4 (sig created 2014-12-15)
  hashed subpkt 27 len 1 (key flags: 02)
  subpkt 16 len 8 (issuer key ID 8A20F7D9D02291A5)
  subpkt 32 len 156 (signature: v4, class 0x19, algo 1, digest algo 2)
  data: [1022 bits]
-->

<textarea id="SignOnlyPublicKey">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1

mI0EVI7xhAEEAKlKrmSbRg0JMvo+oW0KT2HLMZkFxQIDgFLiSYcqLBUA2MxtMxjc
Y+jY0+/gz9owKCZUSkoCk90ntybEAJYqnWJLrKIgllR8cBq6hU+c9P94x7jG7LhT
rP85IhrLQ677zD8es8DQe8+tPw1J8/A5jKasY0aS7Picxqe2V6zRllwfABEBAAG0
G2dwZy10ZXN0IDxncGctczJrQHRlc3QuY29tPoi4BBMBAgAiBQJUjvGEAhsBBgsJ
CAcDAgYVCAIJCgsEFgIDAQIeAQIXgAAKCRCKIPfZ0CKRpWUhBACMri9E/kcqcCxl
3p+/xq2WChmS5g8dJ+QVZsXHudwWqAtUUjk94f+3FgD1CI34W5l8Ycz2nD9Z7GWA
wclTgplpIcqUB4wi8XFPjgZQW3TXZWE6qSiiWcUn6Qdu+vSQyY1z+HLcbjcr/+Ig
pQHRxnyg/Pgk/OA+7RpqEI6U9kA/friNBFSO8ZUBBADUKdzdW3FKscFug6AYQSIP
xxqfd/2GjA+apulnw1ysLUq8Mr/h/tnXTaUQ2XpnhJcbpoWvGIR2C+djdISwHVLg
I1OIgJJ5AaprBU4zti5OgliCQfAPFQdl258l8c9zm510uHy3Uz2FFH7N/0fQM21h
1TeS8FJYAYfenvE/IfCDBwARAQABiQE9BBgBAgAJBQJUjvGVAhsCAKgJEIog99nQ
IpGlnSAEGQECAAYFAlSO8ZUACgkQh+vCfUyo4w3wZQQAxCkx0G/rJj5P5LM6LCGV
RYqIRSjegd/r6x/BQfkFbmjJg4BxUiT6ruQ/BWYHflCnHoixZZTu0cGvowJQFrr7
RDvKaayIqh+na0vyfVL2+KVBfe3Kbu48c5tHtCuqz2nWbFq+wGprMxOERA1khNAO
QwFWoGjooCC4i+8rOAPXsWbB5QP+JbFfzPLCRQFT4Wk+pvNCo+uABkv/gy8MjJcf
osdAczCNqo89EOpkFWaRsiQGvu7Z2srXoiUObUMqLpGpjNM467vc/RAK5OF5lqKZ
hZN0w0g1mpYHmnL1dPhMBdM5nicOZurepAWF4qWk8+7uX42u7LRuEE1xB9yeOG4X
d8SAPYc=
=fFTC
-----END PGP PUBLIC KEY BLOCK-----
</textarea>

<!--
Only secret signing and encryption subkeys are available. This is a
somewhat used configuration for gnupg; where the certification
(primary) secret key is stored elsewhere, and only secret subkeys are
generated/used inside multiple devices/implementations.

Ensure we can import, and return the correct subkeys when requested.

:secret key packet:
  version 4, algo 1, created 1418865844, expires 0
  skey[0]: [1024 bits]
  skey[1]: [17 bits]
  gnu-dummy S2K, algo: 3, SHA1 protection, hash: 2
  protect IV:
  keyid: 354F6BFEC9789F00
:user ID packet: "subkey-only <sub@key.only>"
:signature packet: algo 1, keyid 354F6BFEC9789F00
  version 4, created 1418865844, md5len 0, sigclass 0x13
  digest algo 2, begin of digest f6 6f
  hashed subpkt 2 len 4 (sig created 2014-12-18)
  hashed subpkt 27 len 1 (key flags: 01)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID 354F6BFEC9789F00)
  data: [1024 bits]
:secret sub key packet:
  version 4, algo 1, created 1418866003, expires 0
  skey[0]: [1024 bits]
  skey[1]: [17 bits]
  iter+salt S2K, algo: 3, SHA1 protection, hash: 2, salt: 3b305916d790802e
  protect count: 65536 (96)
  protect IV:  9a dd 5b 63 af 00 78 1a
  encrypted stuff follows
  keyid: A544CE2DFDAF0B58
:signature packet: algo 1, keyid 354F6BFEC9789F00
  version 4, created 1418866003, md5len 0, sigclass 0x18
  digest algo 2, begin of digest bf 02
  hashed subpkt 2 len 4 (sig created 2014-12-18)
  hashed subpkt 27 len 1 (key flags: 02)
  subpkt 16 len 8 (issuer key ID 354F6BFEC9789F00)
  subpkt 32 len 156 (signature: v4, class 0x19, algo 1, digest algo 2)
  data: [1021 bits]
:secret sub key packet:
  version 4, algo 1, created 1418867855, expires 0
  skey[0]: [1024 bits]
  skey[1]: [17 bits]
  iter+salt S2K, algo: 3, SHA1 protection, hash: 2, salt: 1f6ce8fc83014f2c
  protect count: 65536 (96)
  protect IV:  85 38 a8 6e a7 f6 5a 06
  encrypted stuff follows
  keyid: 1389A78D4206E4CD
:signature packet: algo 1, keyid 354F6BFEC9789F00
  version 4, created 1418867855, md5len 0, sigclass 0x18
  digest algo 2, begin of digest 1a d0
  hashed subpkt 2 len 4 (sig created 2014-12-18)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID 354F6BFEC9789F00)
  data: [1024 bits]
-->
<textarea id="SubkeyOnlySecretKey">
-----BEGIN PGP PRIVATE KEY BLOCK-----
Version: GnuPG v1

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
/Q==
=iqk+
-----END PGP PRIVATE KEY BLOCK-----
</textarea>

<!--
Secret key DSA/DSA with no explicit keyflags set - the subkey
should be selected for signing operations.

:secret key packet:
  version 4, algo 17, created 1410274798, expires 0
  skey[0]: [1024 bits]
  skey[1]: [160 bits]
  skey[2]: [1023 bits]
  skey[3]: [1023 bits]
  iter+salt S2K, algo: 7, SHA1 protection, hash: 8, salt: 0e5250d32bd85b90
  protect count: 65536 (96)
  protect IV:  1b ac 10 8d 0d 66 72 ee 61 c1 a6 22 0b 7f 75 91
  encrypted stuff follows
  keyid: B471D19456481C9A
:user ID packet: "default-key-usage"
:signature packet: algo 17, keyid B471D19456481C9A
  version 4, created 1418914798, md5len 0, sigclass 0x13
  digest algo 2, begin of digest d6 4d
  hashed subpkt 2 len 4 (sig created 2014-12-18)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  subpkt 16 len 8 (issuer key ID B471D19456481C9A)
  data: [160 bits]
  data: [159 bits]
:secret sub key packet:
  version 4, algo 17, created 1410274798, expires 0
  skey[0]: [1024 bits]
  skey[1]: [160 bits]
  skey[2]: [1023 bits]
  skey[3]: [1021 bits]
  iter+salt S2K, algo: 7, SHA1 protection, hash: 8, salt: 0e5250d32bd85b90
  protect count: 65536 (96)
  protect IV:  57 92 12 db d4 64 38 03 b8 e2 55 00 0f 44 b9 3d
  encrypted stuff follows
  keyid: 2AD936C0DDB2552A
:signature packet: algo 17, keyid B471D19456481C9A
  version 4, created 1410274798, md5len 0, sigclass 0x18
  digest algo 2, begin of digest f0 62
  hashed subpkt 2 len 4 (sig created 2014-09-09)
  subpkt 16 len 8 (issuer key ID B471D19456481C9A)
  data: [159 bits]
  data: [160 bits]
-->
<textarea id="DSADSADefaultKeyUsage">
-----BEGIN PGP PRIVATE KEY BLOCK-----
Version: GnuPG v1

lQHpBFQPFe4RBACOY5b4/FYCkuvu5rV2lbqTGUkzNH5OFFMnugh99sfVR2jIv3mf
q1dluTqy5S8CVj2q6qJgNCKpZ+Bnzsrx7jmFnGmkSjw6VtjN8f3U0D4r+suzI2CZ
R8t7b/Jc+qCXLrD4SjwBAtGBvs3oXfnrngf+kp18T5QRWvt0ay0EE75PqwCg5+PO
oL2tnxjj9NVQbGr8m9+sl7UD/2WFP/KM8KS4ezu7HQUDA7x8sYfD2DaSfPuxbFE8
Kvqa2xRX0Sa6kF+RfiWV/XbcTaQbi2E251MfbyfcZS7OTo87sd53btlCYdRPxgiS
/E7ImKxFJXVwKbPozslfxoNj0mfwr8qY9CpJISnrGACY92pOcDSSat2baEC2tuwu
inJlA/9YXoLn3h7IHFDBs0eKLhlMnKizrzOs5gpn6K3TygEC6OgLvj3r90YzXqNh
0vkDMfhopMN3A9/NwNl2LYunzixYg+7iPXUW8FVO6HlWNd5sZYdSgHBp8noJkg0D
GcUDiB5jyNIz+aMFsva+eYUmrDs4hQlQs+n3mJnwAV/hbUZIA/4HAwgOUlDTK9hb
kGAbrBCNDWZy7mHBpiILf3WRvGqj/b3RqxEKOhzm/jia/6hpriHsf6RWlxin4XT6
V/8kbBha5m/jyTKftBFkZWZhdWx0LWtleS11c2FnZYhPBBMRAgAPBQJUkuvuAgsH
AhUIAh4BAAoJELRx0ZRWSBya1k0AoMLrV18HalT4HXwkxaErh4TyEJ1kAJ9imD6u
Pa1llv6cvNvmY+dkeuA8450B6QRUDxXuEQQAjmOW+PxWApLr7ua1dpW6kxlJMzR+
ThRTJ7oIffbH1UdoyL95n6tXZbk6suUvAlY9quqiYDQiqWfgZ87K8e45hZxppEo8
OlbYzfH91NA+K/rLsyNgmUfLe2/yXPqgly6w+Eo8AQLRgb7N6F35654H/pKdfE+U
EVr7dGstBBO+T6sAoOfjzqC9rZ8Y4/TVUGxq/JvfrJe1A/9lhT/yjPCkuHs7ux0F
AwO8fLGHw9g2knz7sWxRPCr6mtsUV9EmupBfkX4llf123E2kG4thNudTH28n3GUu
zk6PO7Hed27ZQmHUT8YIkvxOyJisRSV1cCmz6M7JX8aDY9Jn8K/KmPQqSSEp6xgA
mPdqTnA0kmrdm2hAtrbsLopyZQP9H1zlZtnEsCyB/72o1EkTUCC1y8NRvtV3g7O6
qyc4jRTTkBnRppwuisloSHj4trVQIbHm7QAjDs6Q+hTENNR4btFAQPT4OYBIiDj7
+jf6TfZwA1q7HVkk6tAFPDYPXFnG6W/Q219TgvdvNrHqEHhNDWdjNKi2U90X6Oc7
7zjDV1L+BwMIDlJQ0yvYW5BgV5IS29RkOAO44lUAD0S5PZIW7x8Grvoph6goKbD1
+yCaUEhzcuedD8JLyfedlALDs1cKg0RqWBNCx4hGBBgRAgAGBQJUDxXuAAoJELRx
0ZRWSBya8GIAn1czWNBsYw3zwAa4l5DF+yRPzgKkAKDQpnBen+0rk+S/N1CusDNB
CgAJ0w==
=FN/h
-----END PGP PRIVATE KEY BLOCK-----
</textarea>

<!--
 RSA-s/RSA-e key but with no explicit key-usage flags. The
 appropriate key should be picked up for encryption/signing.

:public key packet:
  version 4, algo 3, created 1410288017, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
  keyid: 04C78703EFBF9416
:user ID packet: "rsa-rsa-default"
:signature packet: algo 3, keyid 04C78703EFBF9416
  version 4, created 1418928017, md5len 0, sigclass 0x13
  digest algo 2, begin of digest a7 ca
  hashed subpkt 2 len 4 (sig created 2014-12-18)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  subpkt 16 len 8 (issuer key ID 04C78703EFBF9416)
  data: [1022 bits]
:public sub key packet:
  version 4, algo 2, created 1410288017, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
  keyid: D768A4153A7326C3
:signature packet: algo 3, keyid 04C78703EFBF9416
  version 4, created 1410288017, md5len 0, sigclass 0x18
  digest algo 2, begin of digest 21 4a
  hashed subpkt 2 len 4 (sig created 2014-09-09)
  subpkt 16 len 8 (issuer key ID 04C78703EFBF9416)
  data: [1020 bits]

-->
<textarea id="RSARSADefaultKeyUsage">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1

mI0EVA9JkQMEAJr4nAio6oS1NjJousigaCEZQWPLzu7S2SH1873RklKJEcex5RXc
6IZUCeFh27vYpGiMVsHn389jnZYj4xdbG8qGsdEq5OT7+aW31Uk/Ro2nRPSs/E0T
rS2DOY/8INffAt+C87wF+S7cQbPEeGOKBTcmWGqqxX4rZsBPl3VxagxxABEBAAG0
D3JzYS1yc2EtZGVmYXVsdIilBBMDAgAPBQJUkx+RAgsHAhUIAh4BAAoJEATHhwPv
v5QWp8oD/jDlPbR4AgpEwLqYOI5dUO0gQoG2G+2JK2qCNuy8SMTMBfiPz1TW62Hn
mOFz1wWRgwNwIl4+F1qC4o8nxORIKyXJBngUhekSifWoWPyMzp2om7Ipta/dQjKU
wZV2fVStiqqK1u7l1t0pYLs3Giy8V0PAflDKkVIZqw9xCJegK6RauI0EVA9JkQIE
AJE6gdvcDLDc/O5b+Blh/8e/fARxcDBpSJsOE86n7N2Prve3Fa17sBT2T1pPDOiB
3YmQv6pHC1afFHb5qnsFY/5aS3mp+zsmNW0L2oD4vSY0QRnKIzBh33QZv2Di5kKf
FNIOGgMovmsyXISZYeAwsnLDSSTbsgHjGR8fqdyf7BaHABEBAAGInAQYAwIABgUC
VA9JkQAKCRAEx4cD77+UFiFKA/wOG2PxB1iDtDeLAUfOP0zMx6qBQfWCyWldKze/
bom5SwbLT42+Aks9B0RU6JKdd8WfwTlJyQeM56aUe1wPwVHBe+zTG+XvsYree3rQ
HFEgHTN3KEPHc6EcQqrhcYJ4IBFau0avBvi7QjsSOvePvIKFO/DuDIECRpLZjRW+
VKisag==
=fTBV
-----END PGP PUBLIC KEY BLOCK-----
</textarea>

<!--
UID with an expired certification signature.
:public key packet:
  version 4, algo 1, created 1400629566, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:user ID packet: "expired-key"
:signature packet: algo 1, keyid 0B448FF3EF40D052
  version 4, created 1400629566, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 11 65
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  critical hashed subpkt 2 len 4 (sig created 2014-05-20)
  critical hashed subpkt 3 len 4 (sig expires after 1d0h0m)
  subpkt 16 len 8 (issuer key ID 0B448FF3EF40D052)
  data: [2047 bits]
:user ID packet: "good-key"
:signature packet: algo 1, keyid 0B448FF3EF40D052
  version 4, created 1409270276, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 9d 08
  hashed subpkt 2 len 4 (sig created 2014-08-28)
  hashed subpkt 27 len 1 (key flags: 2F)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID 0B448FF3EF40D052)
  data: [2046 bits]
-->
<textarea id="ExpiredUid">
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQENBFN76T4BCACA04Pjpjl4i2+5tM/o5p3nFDuYga8ApFgBJHaQkYExYktGqi5j
a9q4DTDCt9j+wJorzBryJuDYA6y32WHY5TPFShBArSZC4rx/ObDFUBRgSP85cQDP
kcAXVmBHH1X3DtB5apgPtrehY3U8O3Ii/yQlTCfXxUVvpVZMYt+c+7+ZAPIsttlt
oHKDw1P8ZOHruU7lzMrmOaALdcyPphHzoF0jaxnmX5lpRua4TIqUz7CwiSBZdZr5
GP3lVL9x6z4MSVpdotkMxlK7ucyoISNDG1Bd/MUN7salkiFynMvkX8UC//KbIgqa
9WI66j9R3L007RAz+AyLuL3O0zsMqJguTH9FABEBAAG0C2V4cGlyZWQta2V5iQEu
BBMBAgAYAhsDAgsHAhUIAh4BBYJTe+k+BYMAAVGAAAoJEAtEj/PvQNBSEWUH/3E8
JmeWH4KzKDWOaufQCEaZR6pwTcINPOM4vzP098zmcaYy6KeavQe1KqfNo90JE2XX
l9VvwA3DKDDMZ1T1RdwOZtLs3ItnUEGMUaDHx2teQyRzUAtTEGRe4jKE5H0D2AH3
/ZWDSohKFp/qmZvTZ5/s27At9omj/Hys/2H4SoSZT8TJfo9qC5dtziSHroPqF3xx
d6irZf900+Psf6reIusENz6n030pvSiT18pmCP8JDcJlbcSiZN2ixHQkCiM8Jnrf
JFZ0/MqAxP1+dqN9U8XD1sKeq7iZWJjOTHOqMb+Tmek5/nQfzd22WRam5mzB5qnX
Fz5qykc9wJLpO3vsJrG0CGdvb2Qta2V5iQE4BBMBAgAiBQJT/8IEAhsvBgsJCAcD
AgYVCAIJCgsEFgIDAQIeAQIXgAAKCRALRI/z70DQUp0IB/4m1G60KnB1bF1xg6pv
8CPcDZMQKWHsKbAdA1bLJjNjfXQPBDXcDAS9yfyqKV5cy7Jkz4oOkeYTpy9iKqIn
Nq97JChuHFYuxfzs0EQAxK/0hpE2tNBNgTGM1QkNOVMiMwD3lXT+Y8efo0hgQ1wp
qzL1GLnjrRkaxIYd2Q4NYLcFJxe2vET5ZUilS/Gejd5IQtlnOoPdP9hewPagl9qh
UmrxEV9n1w+hDGiEbX9d+QIeSoZPWJkY6FptI0E2npIOB3LF3UQ83NdhHG+YbVja
5GazLV2afoD//WageNM2vQ0IlRKOHIf8JbJMX6Qhf33dq2tjNaziNBs4gjf79ZU4
aDYh
=gHUD
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Three signatures on a uid, with one revocation signature. However, the
latest signature is a certification, which should mark the key as
being certified for the provided userid.
:public key packet:
  version 4, algo 1, created 1412023581, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
  keyid: 57CC7CB355BA0491
:user ID packet: "should-not-expire"
:signature packet: algo 1, keyid 57CC7CB355BA0491
  version 4, created 1412023581, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 6f a0
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  critical hashed subpkt 2 len 4 (sig created 2014-09-29)
  subpkt 16 len 8 (issuer key ID 57CC7CB355BA0491)
  data: [1023 bits]
:signature packet: algo 1, keyid 57CC7CB355BA0491
  version 4, created 1419799581, md5len 0, sigclass 0x30
  digest algo 2, begin of digest 7b 8b
  critical hashed subpkt 2 len 4 (sig created 2014-12-28)
  subpkt 16 len 8 (issuer key ID 57CC7CB355BA0491)
  data: [1023 bits]
:signature packet: algo 1, keyid 57CC7CB355BA0491
  version 4, created 1420231581, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 2d fc
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  critical hashed subpkt 2 len 4 (sig created 2015-01-02)
  subpkt 16 len 8 (issuer key ID 57CC7CB355BA0491)
  data: [1023 bits]
-->
<textarea id="ValidUid">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1

mI0EVCnFHQEEAKDhazuhtDroMEiRVfLu2F/mAe/zgvtK+YuVyHWp2bDj+sYamlc+
2ZentqbE0D7YHxw5lhbX+U/Qv2k1zDxakKKs+Dr8gbsYFI4ha/kXuztQTta+50Pc
5C8zmsx73mIJ/VO/NT+a3wkr/N0OeHcDd1ZPA5rDup57TlmkjlZzm/3rABEBAAG0
EXNob3VsZC1ub3QtZXhwaXJliKgEEwECABICGwMCCwcCFQgCHgEFglQpxR0ACgkQ
V8x8s1W6BJFvoAP/S29CS1hLzTFFN60RRZxMxcDevHOxIb5SsrfFAuyo4rEtHZi/
cf3OgNGOIe5vrTwUrIu91RT7Y/2GaC5cuotrutBjjSLb/ZfkUB7ZRbh5v/xOqZpl
aNVGtxVIPj6DJhObeSFrzDvrpIsyb973E+1rq5OEcMhPnhlILiv58sC5ozKInAQw
AQIABgWCVKBsHQAKCRBXzHyzVboEkXuLA/9eV5SD9SGCm1b/V9jQ8BA5f5K0XDnM
d99ZoYI8RbH94k092CDT3oAAWdEG4VTtr4FJDldMUCwDLfZZnGqbDHQSTmnzxIGV
g0PF8LaTcemN8hLmUFvyEl/Vt9kg8msQuYY4HLqa9UZK8vS1zQVb0N3pPwgZ8q8a
7tycbupcNFJFooioBBMBAgASAhsDAgsHAhUIAh4BBYJUpwOdAAoJEFfMfLNVugSR
LfwD/1XSqH1GfPRsGd1viG36/QyZ5bOoiqqQlCyaICEyC3+Qd8/uP7iLrFVAY9Rz
5DDBOZKzZlHt0Wv85sNdO13gH6cIsikmHalkuO7+F9GesM7MXzZxO0J0mKjLEe65
Ra3p0vRrD2DhwUd9gHm0KwJy7vEQAoh7b3nz789PZNcVbddz
=dGzQ
-----END PGP PUBLIC KEY BLOCK-----

</textarea>

<!--
Three signatures on a uid, with one recovation signature. However, the
latest signature is a revocation, which should remove the userid from
the key.
:public key packet:
  version 4, algo 1, created 1412024512, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
  keyid: 50F20BB38F54BB0B
:user ID packet: "should-revoke"
:signature packet: algo 1, keyid 50F20BB38F54BB0B
  version 4, created 1412024512, md5len 0, sigclass 0x13
  digest algo 2, begin of digest ef 9f
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  critical hashed subpkt 2 len 4 (sig created 2014-09-29)
  subpkt 16 len 8 (issuer key ID 50F20BB38F54BB0B)
  data: [1024 bits]
:signature packet: algo 1, keyid 50F20BB38F54BB0B
  version 4, created 1420232512, md5len 0, sigclass 0x30
  digest algo 2, begin of digest b2 84
  critical hashed subpkt 2 len 4 (sig created 2015-01-02)
  subpkt 16 len 8 (issuer key ID 50F20BB38F54BB0B)
  data: [1024 bits]
:signature packet: algo 1, keyid 50F20BB38F54BB0B
  version 4, created 1419800512, md5len 0, sigclass 0x13
  digest algo 2, begin of digest a0 0d
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  critical hashed subpkt 2 len 4 (sig created 2014-12-28)
  subpkt 16 len 8 (issuer key ID 50F20BB38F54BB0B)
  data: [1024 bits]
:user ID packet: "good"
:signature packet: algo 1, keyid 50F20BB38F54BB0B
  version 4, created 1420664512, md5len 0, sigclass 0x13
  digest algo 2, begin of digest cd 33
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  critical hashed subpkt 2 len 4 (sig created 2015-01-07)
  subpkt 16 len 8 (issuer key ID 50F20BB38F54BB0B)
  data: [1023 bits]
-->
<textarea id="RevokedUid">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1
Comment: Use "gpg --dearmor" for unpacking

mI0EVCnIwAEEAMOAK0ih0zqegWYOKd5MnQaqiR7aFuvUOPmD8usq1eaL7o2LfzkI
sUDHVPuQWqgExvbV0BhB3pqpWc1POPIj9RqaBuVbDRh3/h9nXb4D+ZieAmLG0vrf
nGhTO4v78Wrr4b37ggJVoPQp2vRQH2alUjMvOmoM33Yr+22hIkzHIosbABEBAAG0
DXNob3VsZC1yZXZva2WIqAQTAQIAEgIbAwILBwIVCAIeAQWCVCnIwAAKCRBQ8guz
j1S7C++fBACYMFGYCyFkCL+oNP8MZsC4NqdHjb4jHVSKD1T7vpNs+J5nsJABcNz1
4U5LiVteQWK+ommchV9LdKNl40axhnXsfAixz7UTA2ArypHaPAP8xv/hAP0wXcn5
5jHxSk4M4rAUH2y+IU2+r8YZNvLCZNKO9kppfSuYDyw5pbs8bMv5BIicBDABAgAG
BYJUpwdAAAoJEFDyC7OPVLsLsoQEAIQlekZqSr/AGg7D9gIQx/l6xXGY7732slQa
cLPZr8Szht2hc31dOICB8erMo2HdsitXOYB5rNloY33FB48NQGOEU/e8ephpgzni
WSztbBX5SVrNgi5mrZlAX98KYhOMb1XvB3lacZZY7sqhmjjdM5m6hyPjYGoxDUyE
PGvnNOpXiKgEEwECABICGwMCCwcCFQgCHgEFglSgb8AACgkQUPILs49UuwugDQQA
lEpsMAtyHW/p2sxiFplHMtOsAsJ1rsRNTKUzGLNCQWNsRAgZwY7J+g2DcIiPxf17
8bpPlESkYIXgzeyABfJqzSsgQqXvyXCoG0XbZ9Y2az/F2BitLAdph3IDcGv2cPch
rm0+J/vPh6eS9Uh8EY6k+iJI0MkX7KbwvwWTGPiTpbO0BGdvb2SIqAQTAQIAEgIb
AwILBwIVCAIeAQWCVK2ewAAKCRBQ8guzj1S7C80zA/9XK4F390WiFWj3Atb8lRQB
fOowa+GGd61is0ohXZNk7E4p5US1ozqOIcrggVKs4k4NckTQnpylIPn5csWEeIJK
HE7RIOSyiEU+ksoJDoGuZqgo0V6C5lGeDqUg1u/bcQcwkE6f/QahD/C9uBGou5SY
VKxljMH6lfwqdGT6xNa5qQ==
=KIyw
-----END PGP PUBLIC KEY BLOCK-----
</textarea>

<!--
Subkey with an expired binding signature
:public key packet:
  version 4, algo 1, created 1400631183, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:user ID packet: "expired-subkey"
:signature packet: algo 1, keyid 6CCE47F4114F7C6B
  version 4, created 1409271184, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 59 9c
  hashed subpkt 2 len 4 (sig created 2014-08-29)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  subpkt 16 len 8 (issuer key ID 6CCE47F4114F7C6B)
  data: [2047 bits]
:public sub key packet:
  version 4, algo 1, created 1400631183, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 6CCE47F4114F7C6B
  version 4, created 1400631183, md5len 0, sigclass 0x18
  digest algo 2, begin of digest 64 b2
  hashed subpkt 27 len 1 (key flags: 0C)
  hashed subpkt 2 len 4 (sig created 2014-05-21)
  hashed subpkt 3 len 4 (sig expires after 1d0h0m)
  subpkt 16 len 8 (issuer key ID 6CCE47F4114F7C6B)
  data: [2046 bits]
-->
<textarea id="ExpiredSubkey">
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQENBFN7748BCADlXXWbsunER3lvTHEElkViIq25VGtakZoaLv3q97VYZ0kIW+qQ
06tSu3CzK+JN0tcYBoejry2f/k6mmIW8IB9OAtkTyOLLyC5cL4hyHe49hqFP5wzI
KPaRphO0qAI7WZyxvGjLkVF7mVSoj8Uu6nTSnEtCg3/axxv2Wtrq5aOD9EoikZMP
wZQpqLM0Tw7yCgckOgDHlTd8LV1Ay1bIYWjj3UmdwrTpAq/noKMMj2zXeiXWjUlv
6J664dICjYmv/NcEqzFpz3R9w7ndRhWZtqhLydc/8zI/IY8q/ebsTi+kZaSW5GIg
U5lcZXE/JpyeMPQKqWol5qpUmYWNJqLqAiklABEBAAG0DmV4cGlyZWQtc3Via2V5
iQEoBBMBAgASBQJT/8WQAhsDAgsHAhUIAh4BAAoJEGzOR/QRT3xrWZwH/2SjkXGc
EinBoVNivrsLGOdrUua/aTY6PDy1J4rIypdDkTtgywvt+KKwL6BjraHhRmVEGU26
oXdrKHXHnuP4MWFUHwsAdPkA6C0cPxeJxrORL/OQ5IPx17LLe2cwVVPBmM8NHbmz
pLuKAFU7Qf0N79RoOfqolfM1wdUDQMvB18YriVGpBLHfujzcnzMfsISFNquRcb+V
Uo5iLJ0Vk/JlkYSop+hGHFb+OWSXx0SC6yXuVSnC635457y+GHbhGy7Y50JCKO4J
UKQctDDZm6AIInBOhnTEGc6RbMSYQhvi7Z/6WJnvxf6abbVKIujHXJq+An2dGVIQ
R7Nlxif2N8MY+XW5AQ0EU3vvjwEIAMUUsMpyABuPhQm3Qu76bg1/P2Wqf8de/oo1
k0grjy177jaGAdViLosvHYdp46BVT/z4NDS1ZVHb2fcuC/0YzVuevHC5IA4fiSUr
QrjMJVB5eB8+Y2fc2matvrZyBmcicUHV/LCQ6de4QFHBKs3Qj9HBIFMLMUMsEVH5
g08uFCUpSgPV2MyB2eAZARZ4Z4O5bLWNpafELNdJ2JgTuHjYH5SkeF5kR5m0KMKw
BizcqxmtzMBipq8DNi8zgkwY2E7ngrtMFLUQSvTVNxQnWGlm/osL7GCXv+Vtuee1
eu/h6Jsf7FCObY9SQs7xxCVWnQC3PNbAfpbrk1bU4nMt9+DBDHUAEQEAAYkBJQQY
AQIADwIbDAUCU3vvjwUDAAFRgAAKCRBszkf0EU98a2SyB/42odA+rA8vw9xiQRQg
bJMW/lmeSBmHI5MmomgtRrYtizDPx//8FsWBi8oPF1sw2vBWZEkqEeVBhhLoqxEk
c2XcjQnOqrYDZ1Cn6W8v+IoKePQNaltJpgcJu/vyUXtf2b6rKVCsAOmJVGzsM+m3
g3iuMSXKi3dWTs0S7ezusfhSqtBZEouRvsnlVUM/ZHhWY8fFpz4UF7ARH9mS2Aqc
hx5JIGRQP5teVX0unJCgdLICk2CmqENqMeg7MyMu1/0KoW+FMgBuD9X9HsqLHD1s
l79KGLk9OEwlEPU9k0ejqC6zUDXp+F01zTTBtrkqI0fgOE9hsrc3IMZLmWLgUKvy
59L+
=9yM7
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Signing subkey that misses a cross-signature
:public key packet:
  version 4, algo 1, created 1394133622, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:user ID packet: "invalid-signing-subkeys"
:signature packet: algo 1, keyid EDD40D05081E923F
  version 4, created 1402773625, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 74 de
  hashed subpkt 2 len 4 (sig created 2014-06-14)
  hashed subpkt 27 len 1 (key flags: 01)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  subpkt 16 len 8 (issuer key ID EDD40D05081E923F)
  data: [2046 bits]
:public sub key packet:
  version 4, algo 1, created 1394133622, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid EDD40D05081E923F
  version 4, created 1402773625, md5len 0, sigclass 0x18
  digest algo 2, begin of digest 4c c2
  hashed subpkt 2 len 4 (sig created 2014-06-14)
  hashed subpkt 27 len 1 (key flags: 02)
  subpkt 16 len 8 (issuer key ID EDD40D05081E923F)
  data: [2043 bits]
-->
<textarea id="MissingCrossSignature">
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQENBFMYynYBCACVOZ3/e8Bm2b9KH9QyIlHGo/i1bnkpqsgXj8tpJ2MIUOnXMMAY
ztW7kKFLCmgVdLIC0vSoLA4yhaLcMojznh/2CcUglZeb6Ao8Gtelr//Rd5DRfPpG
zqcfUo+m+eO1co2Orabw0tZDfGpg5p3AYl0hmxhUyYSc/xUq93xL1UJzBFgYXY54
QsM8dgeQgFseSk/YvdP5SMx1ev+eraUyiiUtWzWrWC1TdyRa5p4UZg6Rkoppf+WJ
QrW6BWrhAtqATHc8ozV7uJjeONjUEq24roRc/OFZdmQQGK6yrzKnnbA6MdHhqpdo
9kWDcXYb7pSE63Lc+OBa5X2GUVvXJLS/3nrtABEBAAG0F2ludmFsaWQtc2lnbmlu
Zy1zdWJrZXlziQEoBBMBAgASBQJTnKB5AhsBAgsHAhUIAh4BAAoJEO3UDQUIHpI/
dN4H/idX4FQ1LIZCnpHS/oxoWQWfpRgdKAEM0qCqjMgiipJeEwSQbqjTCynuh5/R
JlODDz85ABR06aoF4l5ebGLQWFCYifPnJZ/Yf5OYcMGtb7dIbqxWVFL9iLMO/oDL
ioI3dotjPui5e+2hI9pVH1UHB/bZ/GvMGo6Zg0XxLPolKQODMVjpjLAQ0YJ3spew
RAmOGre6tIvbDsMBnm8qREt7a07cBJ6XK7xjxYaZHQBiHVxyEWDa6gyANONx8duW
/fhQ/zDTnyVM/ik6VO0Ty9BhPpcEYLFwh5c1ilFari1ta3e6qKo6ZGa9YMk/REhu
yBHd9nTkI+0CiQUmbckUiVjDKKe5AQ0EUxjKdgEIAJcXQeP+NmuciE99YcJoffxv
2gVLU4ZXBNHEaP0mgaJ1+tmMD089vUQAcyGRvw8jfsNsVZQIOAuRxY94aHQhIRHR
bUzBN28ofo/AJJtfx62C15xt6fDKRV6HXYqAiygrHIpEoRLyiN69iScUsjIJeyFL
C8wa72e8pSL6dkHoaV1N9ZH/xmrJ+k0vsgkQaAh9CzYufncDxcwkoP+aOlGtX1gP
WwWoIbz0JwLEMPHBWvDDXQcQPQTYQyj+LGC9U6f9VZHN25E94subM1MjuT9OhN9Y
MLfWaaIc5WyhLFyQKW2Upofn9wSFi8ubyBnv640Dfd0rVmaWv7LNTZpoZ/GbJAMA
EQEAAYkBHwQYAQIACQUCU5ygeQIbAgAKCRDt1A0FCB6SP0zCB/sEzaVR38vpx+OQ
MMynCBJrakiqDmUZv9xtplY7zsHSQjpd6xGflbU2n+iX99Q+nav0ETQZifNUEd4N
1ljDGQejcTyKD6Pkg6wBL3x9/RJye7Zszazm4+toJXZ8xJ3800+BtaPoI39akYJm
+ijzbskvN0v/j5GOFJwQO0pPRAFtdHqRs9Kf4YanxhedB4dIUblzlIJuKsxFit6N
lgGRblagG3Vv2eBszbxzPbJjHCgVLR3RmrVezKOsZjr/2i7X+xLWIR0uD3IN1qOW
CXQxLBizEEmSNVNxsp7KPGTLnqO3bPtqFirxS9PJLIMPTPLNBY7ZYuPNTMqVIUWF
4artDmrG
=7FfJ
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
SubKey that has an invalid cross-signature
:public key packet:
  version 4, algo 1, created 1394133622, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:user ID packet: "invalid-signing-subkeys"
:signature packet: algo 1, keyid EDD40D05081E923F
  version 4, created 1402773625, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 74 de
  hashed subpkt 2 len 4 (sig created 2014-06-14)
  hashed subpkt 27 len 1 (key flags: 01)
  hashed subpkt 11 len 1 (pref-sym-algos: 7)
  hashed subpkt 21 len 1 (pref-hash-algos: 8)
  hashed subpkt 30 len 1 (features: 01)
  subpkt 16 len 8 (issuer key ID EDD40D05081E923F)
  data: [2046 bits]
:public sub key packet:
  version 4, algo 1, created 1394133622, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid EDD40D05081E923F
  version 4, created 1402773625, md5len 0, sigclass 0x18
  digest algo 2, begin of digest 7b 19
  hashed subpkt 2 len 4 (sig created 2014-06-14)
  hashed subpkt 27 len 1 (key flags: 02)
  hashed subpkt 32 len 284 (signature: v4, class 0x19, algo 1, digest algo 2)
  subpkt 16 len 8 (issuer key ID EDD40D05081E923F)
  data: [2047 bits]
  -->
<textarea id="InvalidCrossSignature">
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQENBFMYynYBCACVOZ3/e8Bm2b9KH9QyIlHGo/i1bnkpqsgXj8tpJ2MIUOnXMMAY
ztW7kKFLCmgVdLIC0vSoLA4yhaLcMojznh/2CcUglZeb6Ao8Gtelr//Rd5DRfPpG
zqcfUo+m+eO1co2Orabw0tZDfGpg5p3AYl0hmxhUyYSc/xUq93xL1UJzBFgYXY54
QsM8dgeQgFseSk/YvdP5SMx1ev+eraUyiiUtWzWrWC1TdyRa5p4UZg6Rkoppf+WJ
QrW6BWrhAtqATHc8ozV7uJjeONjUEq24roRc/OFZdmQQGK6yrzKnnbA6MdHhqpdo
9kWDcXYb7pSE63Lc+OBa5X2GUVvXJLS/3nrtABEBAAG0F2ludmFsaWQtc2lnbmlu
Zy1zdWJrZXlziQEoBBMBAgASBQJTnKB5AhsBAgsHAhUIAh4BAAoJEO3UDQUIHpI/
dN4H/idX4FQ1LIZCnpHS/oxoWQWfpRgdKAEM0qCqjMgiipJeEwSQbqjTCynuh5/R
JlODDz85ABR06aoF4l5ebGLQWFCYifPnJZ/Yf5OYcMGtb7dIbqxWVFL9iLMO/oDL
ioI3dotjPui5e+2hI9pVH1UHB/bZ/GvMGo6Zg0XxLPolKQODMVjpjLAQ0YJ3spew
RAmOGre6tIvbDsMBnm8qREt7a07cBJ6XK7xjxYaZHQBiHVxyEWDa6gyANONx8duW
/fhQ/zDTnyVM/ik6VO0Ty9BhPpcEYLFwh5c1ilFari1ta3e6qKo6ZGa9YMk/REhu
yBHd9nTkI+0CiQUmbckUiVjDKKe5AQ0EUxjKdgEIAIINDqlj7X6jYKc6DjwrOkjQ
UIRWbQQar0LwmNilehmt70g5DCL1SYm9q4LcgJJ2Nhxj0/5qqsYib50OSWMcKeEe
iRXpXzv1ObpcQtI5ithp0gR53YPXBib80t3bUzomQ5UyZqAAHzMp3BKC54/vUrSK
FeRaxDzNLrCeyI00+LHNUtwghAqHvdNcsIf8VRumK8oTm3RmDh0TyjASWYbrt9c8
R1Um3zuoACOVy+mEIgIzsfHq0u7dwYwJB5+KeM7ZLx+HGIYdUYzHuUE1sLwVoELh
+SHIGHI1HDicOjzqgajShuIjj5hZTyQySVprrsLKiXS6NEwHAP20+XjayJ/R3tEA
EQEAAYkCPgQYAQIBKAUCU5ygeQIbAsBdIAQZAQIABgUCU5ygeQAKCRCpVlnFZmhO
52RJB/9uD1MSa0wjY6tHOIgquZcP3bHBvHmrHNMw9HR2wRCMO91ZkhrpdS3ZHtgb
u3/55etj0FdvDo1tb8P8FGSVtO5Vcwf5APM8sbbqoi8L951Q3i7qt847lfhu6sMl
w0LWFvPTOLHrliZHItPRjOltS1WAWfr2jUYhsU9ytaDAJmvf9DujxEOsN5G1YJep
54JCKVCkM/y585Zcnn+yxk/XwqoNQ0/iJUT9qRrZWvoeasxhl1PQcwihCwss44A+
YXaAt3hbk+6LEQuZoYS73yR3WHj+42tfm7YxRGeubXfgCEz/brETEWXMh4pe0vCL
bfWrmfSPq2rDegYcAybxRQz0lF8PAAoJEO3UDQUIHpI/exkH/0vQfdHA8g/N4T6E
i6b1CUVBAkvtdJpCATZjWPhXmShOw62gkDw306vHPilL4SCvEEi4KzG72zkp6VsB
DSRcpxCwT4mHue+duiy53/aRMtSJ+vDfiV1Vhq+3sWAck/yUtfDU9/u4eFaiNok1
8/Gd7reyuZt5CiJnpdPpjCwelK21l2w7sHAnJF55ITXdOxI8oG3BRKufz0z5lyDY
s2tXYmhhQIggdgelN8LbcMhWs/PBbtUr6uZlNJG2lW1yscD4aI529VjwJlCeo745
U7pO4eF05VViUJ2mmfoivL3tkhoTUWhx8xs8xCUcCg8DoEoSIhxtOmoTPR22Z9BL
6LCg2mg=
=Dhm4
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Signature subpacket has an invalid length for one of its attributes
(The issuer key ID is tagged with a length of 190 bytes, but is
 only 8 bytes in reality.)
The signature packet should be discarded, which should then cause the
certificate to be rejected.
Old: Public Key Packet(tag 6)(269 bytes)
  Ver 4 - new
  Public key creation time - Sat Aug  9 16:31:45 PDT 2014
  Pub alg - RSA Encrypt or Sign(pub 1)
  RSA n(2048 bits) - ...
  RSA e(17 bits) - ...
New: User ID Packet(tag 13)(8 bytes)
  User ID - The 𝌆
Old: Signature Packet(tag 2)(296 bytes)
  Ver 4 - new
  Sig type - Positive certification of a User ID and Public Key packet(0x13).
  Pub alg - RSA Encrypt or Sign(pub 1)
  Hash alg - SHA1(hash 2)
  Hashed Sub: key flags(sub 27)(1 bytes)
    Flag - This key may be used to certify other keys
  Hashed Sub: preferred symmetric algorithms(sub 11)(1 bytes)
    Sym alg - AES with 128-bit key(sym 7)
  Hashed Sub: preferred hash algorithms(sub 21)(1 bytes)
    Hash alg - SHA256(hash 8)
  Hashed Sub: features(sub 30)(1 bytes)
    Flag - Modification detection (packets 18 and 19)
  Hashed Sub: signature creation time(sub 2)(4 bytes)
    Time - Sat Aug  9 16:31:45 PDT 2014
  Sub: issuer key ID(sub 16)(190 bytes)
    Key ID - 0x38D48534E5B68CCB
  Hash left 2 bytes - 84 16
  RSA m^d mod n(2048 bits) - ...
    -> PKCS-1
-->
<textarea id="InvalidSubpacketLength">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1

mQENBFPmr2EBCACn2FimzdgSY7K1CG8M7hdz3/nQ7hHVM2ulG/WtEe6ZdlHG1mo7
i4jo2JzlAdLhnF/mZwuMJ72Wy+QUJ5Um38d6ly95RmlXPkNDz01Mb+f9YF3u36TV
o7NTIzcgK6T9kVp6ksr3IktoW3rKKFUsTkKnUuCCbl843x0uqGu3fv7JEC/AVPUt
hPNYFCttDr07p00cNbrBr8+QJXBDx//SZtCYmjrtpFP0HmARvRknx1tAun0+S9AG
AsOJLdXu8ZJPWHqwNb38J69uVk5W7dpGe0ZQdx9n9EfYXDv/wWT+8/c7YGLqCtIf
qMXW+PKdgAo5xqL4S+rqfGZHlT5y8fyIhY45ABEBAAHNCFRoZSDwnYyGiQEoBBMB
AgASAhsBAgsHAhUIAh4BBQJT5q9hAAq/EDjUhTTltozLhBYIAJYP08yoeKWk5cj0
B9Y51PEzII8fGrJDeoltJ+O1iPBteiA0Es3Q3XOXtkjqPFMzDpgjEpqAj+fSE5VC
AsGP63ozSg4zOCDF8k++/iX+t5A3i+xGTZmknisccjVdcx/1nVFBK8dEy6WE+ir9
f74GEqERKGvgLyFXlS6dXzs5J1gSY0pOq5NxYkHauz/9QIKSoxMxDad0AJbVegBX
ESFbpA5UETgojzviA6Q/jz6c0N1cHTEQD2MnTsk8xRSnRsYG6AL96f4i6cwpdV2I
CW4s/mR2ZILuKKsS6WxY8Q8AVeKMW4cXWJZO/cMwok9Gk8oZORdWr8AkVxOLfvf/
aCOr+QE=
=d3vQ
-----END PGP PUBLIC KEY BLOCK-----
</textarea>

<script>
function getKey(id) {
  return e2e.openpgp.block.factory.parseAscii(
      document.getElementById(id).value);
}

function getUidCertifications(uid) {
  var ret = [];
  uid.forEachSignature_(function(sig) {
    if (sig.isCertificationSignature()) {
      ret.push(sig);
    }
  });
  return ret;
}

function getUidRevocations(uid) {
  var ret = [];
  uid.forEachSignature_(function(sig) {
    if (sig.signatureType ==
        e2e.openpgp.packet.Signature.SignatureType.CERTIFICATION_REVOCATION) {
      ret.push(sig);
    }
  });
  return ret;
}

function testSigningSubkey() {
  var key = getKey('SigningSubkey');
  var mainKeyId = key.keyPacket.keyId;
  var signingSubKey = key.subKeys[1];
  var bindingSig = signingSubKey.bindingSignatures_.get(0);
  assertArrayEquals(mainKeyId, bindingSig.getSignerKeyId());
  assertTrue(bindingSig.embeddedSignature
      instanceof e2e.openpgp.packet.Signature);
  assertTrue(Boolean(bindingSig.attributes.KEY_FLAG_SIGN));
  var crossSignature = bindingSig.embeddedSignature;
  assertArrayEquals(signingSubKey.keyId, crossSignature.getSignerKeyId());
  assertEquals(e2e.openpgp.packet.Signature.SignatureType.PRIMARY_KEY,
      crossSignature.signatureType);
  key.processSignatures();
  assertEquals(2, key.subKeys.length);
}

function testEmbeddedSignatures() {
  var key, error;
  // Remove embedded signature
  key = getKey('SigningSubkey');
  delete key.subKeys[1].bindingSignatures_.get(0).embeddedSignature;
  error = assertThrows(function() {
    key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
  // Tamper signature type
  key = getKey('SigningSubkey');
  key.subKeys[1].bindingSignatures_.get(0).embeddedSignature.signatureType =
      e2e.openpgp.packet.Signature.SignatureType.SUBKEY;
  error = assertThrows(function() {
    key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
  // Invalidate signature
  key = getKey('SigningSubkey');
  key.subKeys[1].bindingSignatures_.get(0).embeddedSignature.signature.s[0] ^= 0x01;
  error = assertThrows(function() {
    key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
}


function testSignatureVerification() {
  var keyBlock = getKey('EccKey');
  assertEquals(1, keyBlock.subKeys[0].bindingSignatures_.size());
  assertEquals(
      e2e.openpgp.packet.Signature.SignatureType.SUBKEY,
      keyBlock.subKeys[0].bindingSignatures_.get(0).signatureType);
  assertArrayEquals(
      keyBlock.subKeys[0].bindingSignatures_.get(0).untrustedAttributes.ISSUER,
      keyBlock.keyPacket.keyId);
  // Modify the signature.
  keyBlock.subKeys[0].bindingSignatures_.get(0).signature.s[0] ^= 0x01;

  var tamperedAscii = e2e.openpgp.asciiArmor.encode('PUBLIC KEY BLOCK',
      keyBlock.serialize());
  var tamperedKey = e2e.openpgp.block.factory.parseAscii(tamperedAscii);
  var error = assertThrows(function() {
    tamperedKey.processSignatures(); // Signature tampering invalidates the key.
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
}


function testGnupgRevokedSubkey() {
  // Test for https://code.google.com/p/end-to-end/issues/detail?id=60
  // GnuPG places subkey revocation signature packet right after subkey
  // packet.
  var publicKeyBlock = getKey('RevokedSubKey');

  // Parsing revocation signature
  assertEquals(1, publicKeyBlock.subKeys.length);
  var revokedSubkey = publicKeyBlock.subKeys[0];
  assertEquals(1, revokedSubkey.revocations_.size());
  assertEquals(e2e.openpgp.packet.Signature.SignatureType.SUBKEY_REVOCATION,
      revokedSubkey.revocations_.get(0).signatureType);
  assertEquals(e2e.openpgp.packet.Signature.RevocationReason.KEY_COMPROMISED,
      revokedSubkey.revocations_.get(0).attributes.REVOCATION_REASON);
  assertEquals('revoke subkey',
      revokedSubkey.revocations_.get(0).attributes.REVOCATION_REASON_TEXT);
  assertEquals(1, revokedSubkey.bindingSignatures_.size());
  // Applying revocation signature removes the revoked subkey, but the key is
  // still valid.
  publicKeyBlock.processSignatures();
  assertEquals(0, publicKeyBlock.subKeys.length);

  // Tamper revocation signature
  var clone = getKey('RevokedSubKey');
  clone.subKeys[0].revocations_.get(0).signature.s[0] ^= 0x01;
  var tamperedAscii = e2e.openpgp.asciiArmor.encode('PUBLIC KEY BLOCK',
      clone.serialize());
  var error = assertThrows(function() {
      var key = e2e.openpgp.block.factory.parseAscii(tamperedAscii);
      key.processSignatures(); // Signature tampering invalidates the key.
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
}


function testGnupgRevokedMainKey() {
  var publicKeyBlock = getKey('RevokedMainKey');

  assertEquals(1, publicKeyBlock.keyPacket.revocations_.size());
  assertEquals(e2e.openpgp.packet.Signature.SignatureType.KEY_REVOCATION,
      publicKeyBlock.keyPacket.revocations_.get(0).signatureType);
  assertEquals(e2e.openpgp.packet.Signature.RevocationReason.KEY_COMPROMISED,
      publicKeyBlock.keyPacket.revocations_.get(0).attributes.REVOCATION_REASON);
  assertEquals('Main key revocation test',
      publicKeyBlock.keyPacket.revocations_.get(0).attributes.REVOCATION_REASON_TEXT);
  var error = assertThrows(function() {
      // The whole key is revoked, so this throws error
      publicKeyBlock.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);

  // Tamper revocation signature
  publicKeyBlock.keyPacket.revocations_.get(0).signature.s[0] ^= 0x01;
  var tamperedAscii = e2e.openpgp.asciiArmor.encode('PUBLIC KEY BLOCK',
      publicKeyBlock.serialize());
  var error = assertThrows(function() {
      var key = e2e.openpgp.block.factory.parseAscii(tamperedAscii)
      key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
}


function testGnupgRevokedUid() {
  var key = getKey('RevokedUserId');
  var foreignKeyId = [106, 105, 167, 16, 15, 140, 92, 71];
  assertEquals(2, key.userIds.length);

  // Helper function - checks that all the signatures for a given
  // keyid in the uid signature map are in fact issued by the
  // keyid. Also returns a count of the number of certification
  // and revocation signatures for that keyid.
  var checkUidMap = function(uid, keyid) {
    var keyidString = e2e.openpgp.packet.UserId.keyIdToString_(keyid);
    var arr = uid.keyIdSignatureMap_[keyidString];
    var result = { certificationCount: 0, revocationCount: 0};
    for (var i = arr.size() - 1; i >= 0; i--) {
      var signature = arr.get(i);
      assertArrayEquals(keyid, signature.getSignerKeyId());
      if (signature.isCertificationSignature()) {
        result.certificationCount++;
      } else {
        assertEquals(
          e2e.openpgp.packet.Signature.SignatureType.CERTIFICATION_REVOCATION,
          signature.signatureType);
        result.revocationCount++;
      }
    }
    return result;
  };

  // revoked-userid should have one certification, one revocation
  // signature from the primary key, and one certification
  // from the foreign key.
  var result = checkUidMap(key.userIds[0], key.keyPacket.keyId);
  assertEquals(1, result.certificationCount);
  assertEquals(1, result.revocationCount);
  result = checkUidMap(key.userIds[0], foreignKeyId);
  assertEquals(1, result.certificationCount);
  assertEquals(0, result.revocationCount);


  // non-revoked-uid should have one signature from the primary key,
  // and one from the foreign key.
  result = checkUidMap(key.userIds[1], key.keyPacket.keyId);
  assertEquals(1, result.certificationCount);
  assertEquals(0, result.revocationCount);
  result = checkUidMap(key.userIds[1], foreignKeyId);
  assertEquals(1, result.certificationCount);
  assertEquals(0, result.revocationCount);

  // Apply signatures
  key.processSignatures();
  assertEquals(1, key.userIds.length);
  assertEquals('non-revoked-uid <non-revoked-uid@example.com>',
               key.userIds[0].userId);
  result = checkUidMap(key.userIds[0], key.keyPacket.keyId);
  assertEquals(1, result.certificationCount);
  assertEquals(0, result.revocationCount);
  result = checkUidMap(key.userIds[0], foreignKeyId);
  assertEquals(1, result.certificationCount);
  assertEquals(0, result.revocationCount);

  // Check that signature tampering is detected
  key = getKey('RevokedUserId');

  var revocations = getUidRevocations(key.userIds[0]);
  revocations[0].signature.s[0] ^= 0x01;
  assertThrows(function() {
    key.processSignatures();
  });

  // Check that signatures by unknown keys are ignored.
  key = getKey('RevokedUserId');
  revocations = getUidRevocations(key.userIds[0]);
  revocations[0].untrustedAttributes.ISSUER[0] ^= 0x01;
  key.processSignatures();
  assertEquals(2, key.userIds.length);
};

function testGnupgUserAttr() {
  var key = getKey('UserAttr');
  assertEquals(1, key.userIds.length);
  assertEquals(1, key.userAttributes.length);
  key.processSignatures();
  assertEquals(1, key.userIds.length);
  assertEquals(1, key.userAttributes.length);
  key.userAttributes[0].keyIdSignatureMap_ = {};
  // Lack of certification removes User Attribute, but does not throw error.
  key.processSignatures();
  assertEquals(0, key.userAttributes.length);
  // Tampering would throw an error though
  key = getKey('UserAttr');
  key.userAttributes[0].data[0] ^= 0x01;
  var error = assertThrows(function() {
    key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
};

function testKeyUsageFlags() {
  var key = getKey('GnuPgKeyUsageFlags');
  key.processSignatures();
  assertObjectEquals(key.subKeys[1], key.getKeyToEncrypt());
}

function testSignOnlyPublicKey() {
  var key = getKey('SignOnlyPublicKey');
  key.processSignatures();

  // primary key/userid on this key should not sign or encrypt.
  assertEquals(1, key.userIds.length);
  assertEquals(1418654084, key.userIds[0].getCertifiedTime(key.keyPacket));
  assertFalse(key.userIds[0].isCertifiedTo(
      key.keyPacket, e2e.openpgp.packet.Key.Usage.ENCRYPT));
  assertFalse(key.userIds[0].isCertifiedTo(
      key.keyPacket, e2e.openpgp.packet.Key.Usage.SIGN));


  // The single subkey on this key can only sign.
  assertEquals(1, key.subKeys.length);
  assertEquals(1418654101, key.subKeys[0].getCertifiedTime(key.keyPacket));
  assertTrue(key.subKeys[0].isCertifiedTo(
      key.keyPacket, e2e.openpgp.packet.Key.Usage.SIGN));
  assertFalse(key.subKeys[0].isCertifiedTo(
      key.keyPacket, e2e.openpgp.packet.Key.Usage.ENCRYPT));

  // Verify the getter methods return the correct (or no) subkey.
  assertNull(key.getKeyToEncrypt());
  assertEquals(
      key.subKeys[0],
      key.getKeyTo(
          e2e.openpgp.packet.Key.Usage.SIGN, e2e.openpgp.packet.PublicKey));
}

function testSubkeyOnlySecretKey() {
  var key = getKey('SubkeyOnlySecretKey');
  key.processSignatures();

  // primary key/userid on this key should not sign or encrypt.
  assertEquals(1, key.userIds.length);
  assertFalse(key.userIds[0].isCertifiedTo(
      key.keyPacket, e2e.openpgp.packet.Key.Usage.ENCRYPT));
  assertFalse(key.userIds[0].isCertifiedTo(
      key.keyPacket, e2e.openpgp.packet.Key.Usage.SIGN));

  // Get the appropriate subkey when asked.
  var subkey = key.getKeyToSign();
  assertArrayEquals(
      [0xA5, 0x44, 0xCE, 0x2D, 0xFD, 0xAF, 0x0B, 0x58], subkey.keyId);
  subkey = key.getKeyTo(
      e2e.openpgp.packet.Key.Usage.ENCRYPT, e2e.openpgp.packet.SecretKey);
  assertArrayEquals(
      [0x13, 0x89, 0xA7, 0x8D, 0x42, 0x06, 0xE4, 0xCD], subkey.keyId);
}

function testDSADSADefaultKeyUsage() {
  var key = getKey('DSADSADefaultKeyUsage');
  key.processSignatures();

  function assertNoKeyFlags(immutableArray) {
    assertTrue(immutableArray.state_);
    assertEquals(1, immutableArray.elements_.length);
    var signature = immutableArray.elements_[0];
    assertFalse(signature.attributes.hasOwnProperty('KEY_FLAGS'));
  }

  // No explict usage flags on the primary or subkey.
  assertEquals(1, key.userIds.length);
  assertNoKeyFlags(key.userIds[0].keyIdSignatureMap_['b471d19456481c9a']);
  assertEquals(1, key.subKeys.length);
  assertNoKeyFlags(key.subKeys[0].bindingSignatures_);

  // The subkey should be selected for signing
  assertEquals(key.subKeys[0], key.getKeyToSign());

  // No key should be selected for encryption
  assertNull(
      key.getKeyTo(
          e2e.openpgp.packet.Key.Usage.ENCRYPT, e2e.openpgp.packet.SecretKey));
}


function testRSARSADefaultKeyUsage() {
  var key = getKey('RSARSADefaultKeyUsage');
  key.processSignatures();

  // No explict usage flags on the primary or subkey, but
  // algorithm ids carry usage information.
  assertEquals(1, key.userIds.length);
  assertEquals(1, key.subKeys.length);

  // The subkey should be selected for encryption
  assertEquals(key.subKeys[0], key.getKeyToEncrypt());

  // The primary key should be selected for signing-related stuff
  assertEquals(
      key.keyPacket,
      key.getKeyTo(
          e2e.openpgp.packet.Key.Usage.SIGN, e2e.openpgp.packet.PublicKey));
}

function testExpiredUid() {
  var key = getKey('ExpiredUid');
  assertEquals(2, key.userIds.length);
  assertEquals(86400, getUidCertifications(key.userIds[0])[0].attributes.
      SIGNATURE_EXPIRATION_TIME);
  key.processSignatures();
  // Expired User ID gets rejected
  assertEquals(1, key.userIds.length);
  assertEquals('good-key', key.userIds[0].userId);
}

function testValidUid() {
  var key = getKey('ValidUid');
  assertEquals(1, key.userIds.length);
  key.processSignatures();
  assertEquals(1, key.userIds.length);
  assertEquals('should-not-expire', key.userIds[0].userId);
  // Only the latest certification signature should remain.
  assertEquals(1, key.userIds[0].keyIdSignatureMap_['57cc7cb355ba0491'].size());
}

function testRevokedUid() {
  var key = getKey('RevokedUid');
  assertEquals(2, key.userIds.length);
  key.processSignatures();
  assertEquals(1, key.userIds.length);
  assertEquals('good', key.userIds[0].userId);
}

function testExpiredSubkey() {
  var key = getKey('ExpiredSubkey');
  assertEquals(1, key.subKeys.length);
  assertEquals(86400, key.subKeys[0].bindingSignatures_.get(0).attributes.
      SIGNATURE_EXPIRATION_TIME);
  key.processSignatures();
  // Expired User ID gets rejected
  assertEquals(0, key.subKeys.length);
}

function testBadSubkeys() {
  var e = assertThrows(function() {
    getKey('MissingCrossSignature')
  });
  assertTrue(e instanceof e2e.openpgp.error.ParseError);
  assertEquals(e.message, 'Missing required key cross-signature.');
  var key = getKey('InvalidCrossSignature');
  var e = assertThrows(function() {
    key.processSignatures();
  });
  assertTrue(e instanceof e2e.openpgp.error.SignatureError);
  assertEquals(e.message, 'Cross-signature verification failed.');
}

function testInvalidSubpacketLength() {
  var data = e2e.openpgp.asciiArmor.parse(
    document.getElementById('InvalidSubpacketLength').value);
  var keys = e2e.openpgp.block.factory.parseByteArrayAllTransferableKeys(
    data.data, true);
  assertEquals(keys.length, 1);
  var e = assertThrows(function() {
    keys[0].processSignatures();
  });
  assertTrue(e instanceof e2e.openpgp.error.SignatureError);
  assertEquals(e.message, 'No certified user IDs.');
}

</script>
